generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                     String             @id @default(uuid())
  email                  String             @unique
  password               String
  firstName              String
  lastName               String?
  role                   Role
  brandId                String?
  createdAt              DateTime           @default(now())
  updatedAt              DateTime           @updatedAt
  refreshTokenVersion    Int                @default(0)
  active                 Boolean            @default(true)
  phone                  String?
  currentBranchId        String?
  auditLogs              AuditLog[]
  ownedBrands            Brand[]            @relation("BrandOwner")
  CashMovements          CashMovement[]
  CashSessionsClosed     CashSession[]      @relation("SessionClosedBy")
  CashSessionsOpened     CashSession[]      @relation("SessionOpenedBy")
  OrderLog               OrderLog[]
  createdOrders          Order[]            @relation("OrderCreatedBy")
  waiterOrders           Order[]            @relation("OrderWaiter")
  PurchaseOrder          PurchaseOrder[]
  RegisterSessionsClosed RegisterSession[]  @relation("RegisterClosedBy")
  RegisterSessionsOpened RegisterSession[]  @relation("RegisterOpenedBy")
  StockAdjustment        StockAdjustment[]
  StockTransaction       StockTransaction[]
  StockTransfer          StockTransfer[]
  TipAllocation          TipAllocation[]
  tips                   Tip[]
  userBranches           UserBranch[]
  shifts                 Shift[]
  attendanceRecords      Attendance[]
  payrolls               Payroll[]
  employeeProfile        EmployeeProfile?
  brand                  Brand?             @relation("BrandUsers", fields: [brandId], references: [id])
  branch                 Branch?            @relation(fields: [currentBranchId], references: [id])
  branches               Branch[]           @relation("BranchUsers")

  @@index([brandId])
  @@map("users")
}

model Brand {
  id                   String                @id @default(uuid())
  name                 String
  ownerId              String
  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt
  countryId            String?
  currency             String
  email                String                @unique
  url                  String?               @unique
  stripeCustomerId     String?               @unique
  polarCustomerId      String?               @unique
  paymentGateways      Json? // Array of enabled gateways with configs
  defaultGateway       String? // Default payment gateway
  branches             Branch[]
  country              Country?              @relation(fields: [countryId], references: [id])
  owner                User                  @relation("BrandOwner", fields: [ownerId], references: [id])
  CashMovement         CashMovement[]
  CashSession          CashSession[]
  Category             Category[]
  Customer             Customer[]
  KitchenStation       KitchenStation[]
  KitchenTicket        KitchenTicket[]
  MenuCategory         MenuCategory[]
  MenuItem             MenuItem[]
  ModifierGroup        ModifierGroup[]
  Order                Order[]
  Payment              Payment[]
  PrintJob             PrintJob[]
  Printer              Printer[]
  Product              Product[]
  Promotion            Promotion[]
  PurchaseOrder        PurchaseOrder[]
  Recipe               Recipe[]
  RegisterSession      RegisterSession[]
  Register             Register[]
  Reservation          Reservation[]
  ServiceChargeConfig  ServiceChargeConfig[]
  StockAdjustment      StockAdjustment[]
  StockTransaction     StockTransaction[]
  StockTransfer        StockTransfer[]
  subscription         Subscription?
  Supplier             Supplier[]
  Table                Table[]
  TaxRate              TaxRate[]
  TipSettlement        TipSettlement[]
  Tip                  Tip[]
  users                User[]                @relation("BrandUsers")
  WaitlistEntry        WaitlistEntry[]
  Zone                 Zone[]
  AIUsageLog           AIUsageLog[]
  ShiftType            ShiftType[]
  Shift                Shift[]
  Attendance           Attendance[]
  PayrollPeriod        PayrollPeriod[]
  Payroll              Payroll[]
  EmployeeProfile      EmployeeProfile[]
  loyaltyPrograms      LoyaltyProgram[]
  onlineMenus          OnlineMenu[]
  campaigns            Campaign[]
  reviews              Review[]
  giftCards            GiftCard[]
  storeCredits         StoreCredit[]
  deliveryIntegrations DeliveryIntegration[]

  @@unique([ownerId, name])
  @@map("brands")
}

model Branch {
  id                  String                @id @default(uuid())
  name                String
  location            String?
  brandId             String
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt
  countryId           String?
  currency            String
  defaultBillType     BillType              @default(FINE_DINE)
  BranchItemVariant   BranchItemVariant[]
  brand               Brand                 @relation(fields: [brandId], references: [id])
  country             Country?              @relation(fields: [countryId], references: [id])
  CashMovement        CashMovement[]
  CashSession         CashSession[]
  KitchenStation      KitchenStation[]
  KitchenTicket       KitchenTicket[]
  Order               Order[]
  Payment             Payment[]
  PrintJob            PrintJob[]
  Printer             Printer[]
  RegisterSession     RegisterSession[]
  Register            Register[]
  Reservation         Reservation[]
  ServiceChargeConfig ServiceChargeConfig[]
  transfersFrom       StockTransfer[]       @relation("TransferFromBranch")
  transfersTo         StockTransfer[]       @relation("TransferToBranch")
  Table               Table[]
  TaxRate             TaxRate[]
  TipSettlement       TipSettlement[]
  Tip                 Tip[]
  userBranches        UserBranch[]
  User                User[]
  WaitlistEntry       WaitlistEntry[]
  Zone                Zone[]
  users               User[]                @relation("BranchUsers")
  ShiftType           ShiftType[]
  Shift               Shift[]
  Attendance          Attendance[]
  PayrollPeriod       PayrollPeriod[]
  Payroll             Payroll[]

  @@unique([brandId, name])
  @@index([brandId])
  @@map("branches")
}

model UserBranch {
  id        String   @id @default(uuid())
  userId    String
  branchId  String
  isActive  Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  branch    Branch   @relation(fields: [branchId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, branchId])
  @@map("user_branches")
}

model SubscriptionPlan {
  id                    String         @id @default(uuid())
  name                  String
  description           String?
  priceMonthly          Float
  priceYearly           Float
  currency              String
  maxBranches           Int?
  maxStaff              Int?
  features              Json
  trialDays             Int            @default(14)
  createdAt             DateTime       @default(now())
  updatedAt             DateTime       @updatedAt
  isDefault             Boolean        @default(false)
  stripePriceIdMonthly  String?        @unique
  stripePriceIdYearly   String?        @unique
  stripeProductId       String?        @unique
  polarProductIdMonthly String?        @unique
  polarProductIdYearly  String?        @unique
  subscriptions         Subscription[]

  @@unique([name, currency])
  @@map("subscription_plans")
}

model Subscription {
  id                   String                @id @default(uuid())
  brandId              String                @unique
  planId               String
  status               SubscriptionStatus
  trialEndsAt          DateTime?
  currentPeriodEnd     DateTime
  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt
  cancelAtPeriodEnd    Boolean               @default(false)
  canceledAt           DateTime?
  stripePriceId        String?
  stripeSubscriptionId String?               @unique
  polarProductId       String?
  polarSubscriptionId  String?               @unique
  provider             PaymentProvider       @default(STRIPE)
  invoices             SubscriptionInvoice[]
  brand                Brand                 @relation(fields: [brandId], references: [id])
  plan                 SubscriptionPlan      @relation(fields: [planId], references: [id])

  @@index([planId])
  @@index([stripeSubscriptionId])
  @@index([polarSubscriptionId])
  @@map("subscriptions")
}

model SubscriptionInvoice {
  id                    String          @id @default(uuid())
  invoiceNumber         String          @unique
  subscriptionId        String
  brandId               String
  amount                Float
  currency              String
  status                InvoiceStatus   @default(PENDING)
  period                String
  billingPeriod         String
  periodStart           DateTime
  periodEnd             DateTime
  dueDate               DateTime?
  paidAt                DateTime?
  provider              PaymentProvider
  stripeInvoiceId       String?         @unique
  stripePaymentIntentId String?
  polarInvoiceId        String?         @unique
  polarPaymentId        String?
  lineItems             Json
  taxAmount             Float           @default(0)
  discountAmount        Float           @default(0)
  totalAmount           Float
  invoiceUrl            String?
  createdAt             DateTime        @default(now())
  updatedAt             DateTime        @updatedAt
  subscription          Subscription    @relation(fields: [subscriptionId], references: [id])

  @@index([subscriptionId])
  @@index([brandId])
  @@index([status])
  @@index([createdAt])
  @@map("subscription_invoices")
}

model AuditLog {
  id        String   @id @default(uuid())
  userId    String?
  action    String
  entity    String
  entityId  String?
  metadata  Json?
  createdAt DateTime @default(now())
  user      User?    @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([entity, entityId])
  @@map("audit_logs")
}

model AIUsageLog {
  id        String   @id @default(uuid())
  brandId   String
  feature   String
  timestamp DateTime @default(now())
  metadata  Json?
  brand     Brand    @relation(fields: [brandId], references: [id], onDelete: Cascade)

  @@index([brandId])
  @@index([timestamp])
  @@index([feature])
  @@map("ai_usage_logs")
}

model Country {
  id       String   @id @default(uuid())
  code     String   @unique
  name     String
  currency String
  branches Branch[]
  brands   Brand[]

  @@map("countries")
}

model MenuCategory {
  id        String         @id @default(uuid())
  brandId   String
  name      String
  parentId  String?
  sortOrder Int            @default(0)
  isActive  Boolean        @default(true)
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt
  items     ItemCategory[]
  brand     Brand          @relation(fields: [brandId], references: [id])
  parent    MenuCategory?  @relation("CategoryChildren", fields: [parentId], references: [id])
  children  MenuCategory[] @relation("CategoryChildren")

  @@index([brandId])
  @@map("menu_categories")
}

model MenuItem {
  id             String              @id @default(uuid())
  brandId        String
  defaultName    String
  description    String?
  sku            String?             @unique
  imageUrl       String?
  isActive       Boolean             @default(true)
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt
  branchVariants BranchItemVariant[]
  categories     ItemCategory[]
  modifierLinks  ItemModifierGroup[]
  itemRoutes     ItemRoute[]
  i18n           MenuItemI18n[]
  variants       ItemVariant[]
  brand          Brand               @relation(fields: [brandId], references: [id])
  OrderItem      OrderItem[]
  recipes        Recipe[]
  cartItems      CartItem[]

  @@index([brandId])
  @@map("menu_items")
}

model MenuItemI18n {
  itemId      String
  locale      String
  name        String
  description String?
  item        MenuItem @relation(fields: [itemId], references: [id])

  @@id([itemId, locale])
  @@map("menu_item_i18n")
}

model ItemVariant {
  id              String                     @id @default(uuid())
  itemId          String
  name            String
  price           Decimal                    @db.Decimal(12, 2)
  costPrice       Decimal?                   @db.Decimal(12, 2)
  sku             String?
  isActive        Boolean                    @default(true)
  sortOrder       Int                        @default(0)
  createdAt       DateTime                   @default(now())
  updatedAt       DateTime                   @updatedAt
  branchOverrides BranchItemVariant[]
  modifierLinks   ItemVariantModifierGroup[]
  item            MenuItem                   @relation(fields: [itemId], references: [id])
  OrderItem       OrderItem[]
  recipes         Recipe[]
  variantRoutes   VariantRoute[]
  cartItems       CartItem[]

  @@index([itemId])
  @@map("menu_item_variants")
}

model ModifierGroup {
  id           String                     @id @default(uuid())
  brandId      String
  name         String
  minSelect    Int                        @default(0)
  maxSelect    Int                        @default(1)
  required     Boolean                    @default(false)
  isActive     Boolean                    @default(true)
  createdAt    DateTime                   @default(now())
  updatedAt    DateTime                   @updatedAt
  itemLinks    ItemModifierGroup[]
  variantLinks ItemVariantModifierGroup[]
  brand        Brand                      @relation(fields: [brandId], references: [id])
  options      ModifierOption[]

  @@index([brandId])
  @@map("modifier_groups")
}

model ModifierOption {
  id                 String              @id @default(uuid())
  groupId            String
  name               String
  price              Decimal             @db.Decimal(12, 2)
  isActive           Boolean             @default(true)
  sortOrder          Int                 @default(0)
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  group              ModifierGroup       @relation(fields: [groupId], references: [id])
  orderItemModifiers OrderItemModifier[]

  @@index([groupId])
  @@map("modifier_options")
}

/// Pivot: Item ↔ Category (many-to-many)
model ItemCategory {
  itemId     String
  categoryId String
  category   MenuCategory @relation(fields: [categoryId], references: [id])
  item       MenuItem     @relation(fields: [itemId], references: [id])

  @@id([itemId, categoryId])
  @@map("item_categories")
}

/// Pivot: Item ↔ ModifierGroup
model ItemModifierGroup {
  itemId   String
  groupId  String
  required Boolean       @default(false)
  group    ModifierGroup @relation(fields: [groupId], references: [id])
  item     MenuItem      @relation(fields: [itemId], references: [id])

  @@id([itemId, groupId])
  @@map("item_modifier_groups")
}

/// Pivot: Variant ↔ ModifierGroup (lets groups differ by variant)
model ItemVariantModifierGroup {
  variantId String
  groupId   String
  group     ModifierGroup @relation(fields: [groupId], references: [id])
  variant   ItemVariant   @relation(fields: [variantId], references: [id])

  @@id([variantId, groupId])
  @@map("item_variant_modifier_groups")
}

/// Per-branch variant price & availability override
model BranchItemVariant {
  branchId    String
  variantId   String
  price       Decimal?    @db.Decimal(12, 2)
  isAvailable Boolean     @default(true)
  menuItemId  String?
  branch      Branch      @relation(fields: [branchId], references: [id])
  MenuItem    MenuItem?   @relation(fields: [menuItemId], references: [id])
  variant     ItemVariant @relation(fields: [variantId], references: [id])

  @@id([branchId, variantId])
  @@map("branch_item_variants")
}

model Supplier {
  id             String          @id @default(uuid())
  brandId        String
  name           String
  contactName    String?
  phone          String?
  email          String?
  address        String?
  notes          String?
  isActive       Boolean         @default(true)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  purchaseOrders PurchaseOrder[]
  brand          Brand           @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([name])
  @@map("suppliers")
}

model Product {
  id                String              @id @default(uuid())
  brandId           String
  name              String
  sku               String?             @unique
  unit              String
  costPrice         Decimal             @db.Decimal(10, 2)
  isActive          Boolean             @default(true)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  barcode           String?             @unique
  categoryId        String?
  description       String?
  sellPrice         Decimal             @db.Decimal(10, 2)
  trackStock        Boolean             @default(true)
  brand             Brand               @relation(fields: [brandId], references: [id])
  category          Category?           @relation(fields: [categoryId], references: [id])
  PurchaseOrderItem PurchaseOrderItem[]
  RecipeItem        RecipeItem[]
  StockAdjustment   StockAdjustment[]
  stockItems        StockItem[]
  StockTransaction  StockTransaction[]
  StockTransferItem StockTransferItem[]

  @@index([brandId])
  @@index([name])
  @@map("products")
}

model Category {
  id        String    @id @default(uuid())
  brandId   String
  name      String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  brand     Brand     @relation(fields: [brandId], references: [id])
  products  Product[]

  @@index([brandId])
  @@index([name])
  @@map("categories")
}

model StockItem {
  id        String   @id @default(uuid())
  productId String
  quantity  Decimal  @db.Decimal(12, 3)
  location  String?
  updatedAt DateTime @updatedAt
  createdAt DateTime @default(now())
  product   Product  @relation(fields: [productId], references: [id])

  @@index([productId])
  @@map("stock_items")
}

model StockTransaction {
  id        String      @id @default(uuid())
  brandId   String
  productId String
  quantity  Decimal     @db.Decimal(12, 3)
  unitCost  Decimal?    @db.Decimal(10, 2)
  createdAt DateTime    @default(now())
  notes     String?
  reference String?
  userId    String?
  type      StockTxType
  brand     Brand       @relation(fields: [brandId], references: [id])
  product   Product     @relation(fields: [productId], references: [id])
  user      User?       @relation(fields: [userId], references: [id])

  @@index([brandId])
  @@index([productId])
  @@index([type])
  @@map("stock_transactions")
}

model PurchaseOrder {
  id          String              @id @default(uuid())
  brandId     String
  supplierId  String
  code        String?             @unique
  totalAmount Decimal             @db.Decimal(12, 2)
  createdAt   DateTime            @default(now())
  createdBy   String?
  updatedAt   DateTime            @updatedAt
  status      POStatus            @default(DRAFT)
  items       PurchaseOrderItem[]
  terms        String?     
  brand       Brand               @relation(fields: [brandId], references: [id])
  user        User?               @relation(fields: [createdBy], references: [id])
  supplier    Supplier            @relation(fields: [supplierId], references: [id])

  @@index([brandId])
  @@index([supplierId])
  @@map("purchase_orders")
}

model PurchaseOrderItem {
  id              String        @id @default(uuid())
  productId       String
  quantity        Decimal       @db.Decimal(12, 3)
  unitCost        Decimal       @db.Decimal(10, 2)
  purchaseOrderId String
  receivedQty     Decimal       @default(0) @db.Decimal(12, 3)
  product         Product       @relation(fields: [productId], references: [id])
  purchaseOrder   PurchaseOrder @relation(fields: [purchaseOrderId], references: [id])

  @@index([purchaseOrderId])
  @@index([productId])
  @@map("purchase_order_items")
}

model StockAdjustment {
  id        String   @id @default(uuid())
  brandId   String
  productId String
  quantity  Decimal  @db.Decimal(12, 3)
  reason    String
  userId    String?
  createdAt DateTime @default(now())
  brand     Brand    @relation(fields: [brandId], references: [id])
  product   Product  @relation(fields: [productId], references: [id])
  user      User?    @relation(fields: [userId], references: [id])

  @@index([brandId])
  @@index([productId])
  @@map("stock_adjustments")
}

model StockTransfer {
  id           String              @id @default(uuid())
  brandId      String
  fromBranchId String
  toBranchId   String
  createdAt    DateTime            @default(now())
  createdById  String
  status       StockTransferStatus @default(PENDING)
  items        StockTransferItem[]
  brand        Brand               @relation(fields: [brandId], references: [id])
  createdBy    User                @relation(fields: [createdById], references: [id])
  fromBranch   Branch              @relation("TransferFromBranch", fields: [fromBranchId], references: [id])
  toBranch     Branch              @relation("TransferToBranch", fields: [toBranchId], references: [id])

  @@index([brandId])
  @@index([fromBranchId])
  @@index([toBranchId])
  @@index([status])
  @@map("stock_transfers")
}

model StockTransferItem {
  id         String        @id @default(uuid())
  transferId String
  productId  String
  quantity   Decimal       @db.Decimal(12, 3)
  product    Product       @relation(fields: [productId], references: [id])
  transfer   StockTransfer @relation(fields: [transferId], references: [id])

  @@index([transferId])
  @@index([productId])
  @@map("stock_transfer_items")
}

model Recipe {
  id        String       @id @default(uuid())
  brandId   String
  itemId    String?
  variantId String?
  name      String
  isActive  Boolean      @default(true)
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  lines     RecipeItem[]
  brand     Brand        @relation(fields: [brandId], references: [id])
  item      MenuItem?    @relation(fields: [itemId], references: [id])
  variant   ItemVariant? @relation(fields: [variantId], references: [id])

  @@index([brandId])
  @@index([itemId])
  @@index([variantId])
  @@map("recipes")
}

model RecipeItem {
  id        String   @id @default(uuid())
  recipeId  String
  productId String
  quantity  Decimal  @db.Decimal(12, 3)
  wastePct  Decimal? @db.Decimal(5, 2)
  product   Product  @relation(fields: [productId], references: [id])
  recipe    Recipe   @relation(fields: [recipeId], references: [id])

  @@index([recipeId])
  @@index([productId])
  @@map("recipe_items")
}

model Zone {
  id        String   @id @default(uuid())
  name      String
  branchId  String
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  brandId   String?
  tables    Table[]
  branch    Branch   @relation(fields: [branchId], references: [id], onDelete: Cascade)
  Brand     Brand?   @relation(fields: [brandId], references: [id])

  @@index([branchId, name], map: "idx_zone_branch_name")
  @@map("zones")
}

model Table {
  id           String        @id @default(uuid())
  name         String
  capacity     Int
  branchId     String
  zoneId       String?
  status       TableStatus   @default(AVAILABLE)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  brandId      String?
  code         String?       @unique
  orders       Order[]
  reservations Reservation[]
  branch       Branch        @relation(fields: [branchId], references: [id], onDelete: Cascade)
  Brand        Brand?        @relation(fields: [brandId], references: [id])
  zone         Zone?         @relation(fields: [zoneId], references: [id])

  @@index([branchId, name], map: "idx_table_branch_name")
  @@index([zoneId], map: "idx_table_zone")
  @@map("tables")
}

model Register {
  id          String            @id @default(uuid())
  brandId     String?
  branchId    String
  name        String
  isActive    Boolean           @default(true)
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  CashSession CashSession[]
  sessions    RegisterSession[]
  branch      Branch            @relation(fields: [branchId], references: [id], onDelete: Cascade)
  Brand       Brand?            @relation(fields: [brandId], references: [id])

  @@index([branchId, name], map: "idx_register_branch_name")
  @@map("registers")
}

model RegisterSession {
  id             String         @id @default(uuid())
  registerId     String
  brandId        String
  branchId       String
  openedById     String
  closedById     String?
  status         RegisterStatus @default(OPEN)
  openingBalance Decimal        @db.Decimal(12, 2)
  closingBalance Decimal?       @db.Decimal(12, 2)
  notes          String?
  openedAt       DateTime       @default(now())
  closedAt       DateTime?
  payments       Payment[]
  branch         Branch         @relation(fields: [branchId], references: [id])
  brand          Brand          @relation(fields: [brandId], references: [id])
  closedBy       User?          @relation("RegisterClosedBy", fields: [closedById], references: [id])
  openedBy       User           @relation("RegisterOpenedBy", fields: [openedById], references: [id])
  register       Register       @relation(fields: [registerId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([registerId])
  @@map("register_sessions")
}

model CashSession {
  id            String         @id @default(uuid())
  registerId    String
  openedById    String
  closedById    String?
  openingFloat  Decimal        @db.Decimal(12, 2)
  cashSales     Decimal        @default(0) @db.Decimal(12, 2)
  refunds       Decimal        @default(0) @db.Decimal(12, 2)
  paidIn        Decimal        @default(0) @db.Decimal(12, 2)
  paidOut       Decimal        @default(0) @db.Decimal(12, 2)
  adjustments   Decimal        @default(0) @db.Decimal(12, 2)
  expectedClose Decimal        @default(0) @db.Decimal(12, 2)
  countedClose  Decimal?       @db.Decimal(12, 2)
  overShort     Decimal?       @db.Decimal(12, 2)
  status        SessionStatus  @default(OPEN)
  openedAt      DateTime       @default(now())
  closedAt      DateTime?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  brandId       String?
  branchId      String?
  movements     CashMovement[]
  Branch        Branch?        @relation(fields: [branchId], references: [id])
  Brand         Brand?         @relation(fields: [brandId], references: [id])
  closedBy      User?          @relation("SessionClosedBy", fields: [closedById], references: [id])
  openedBy      User           @relation("SessionOpenedBy", fields: [openedById], references: [id])
  register      Register       @relation(fields: [registerId], references: [id], onDelete: Cascade)

  @@index([registerId, status], map: "idx_session_register_status")
  @@index([openedAt], map: "idx_session_opened_at")
  @@map("cash_sessions")
}

model CashMovement {
  id        String       @id @default(uuid())
  sessionId String
  type      MovementType
  amount    Decimal      @db.Decimal(12, 2)
  reason    String?
  orderId   String?
  userId    String?
  createdAt DateTime     @default(now())
  brandId   String?
  branchId  String?
  Branch    Branch?      @relation(fields: [branchId], references: [id])
  Brand     Brand?       @relation(fields: [brandId], references: [id])
  session   CashSession  @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  user      User?        @relation(fields: [userId], references: [id])

  @@index([sessionId, type], map: "idx_movement_session_type")
  @@index([orderId], map: "idx_movement_order")
  @@map("cash_movements")
}

model TaxRate {
  id          String     @id @default(uuid())
  brandId     String
  branchId    String?
  scope       TaxScope
  name        String
  ratePct     Decimal    @db.Decimal(5, 2)
  isInclusive Boolean    @default(false)
  isActive    Boolean    @default(true)
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  OrderTax    OrderTax[]
  branch      Branch?    @relation(fields: [branchId], references: [id])
  brand       Brand      @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@map("tax_rates")
}

model ServiceChargeConfig {
  id        String       @id @default(uuid())
  brandId   String
  branchId  String?
  name      String       @default("Service Charge")
  type      DiscountType @default(PERCENT)
  value     Decimal      @db.Decimal(7, 2)
  minCovers Int?
  isActive  Boolean      @default(true)
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  branch    Branch?      @relation(fields: [branchId], references: [id])
  brand     Brand        @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@map("service_charge_configs")
}

model Customer {
  id                  String               @id @default(uuid())
  brandId             String
  firstName           String
  lastName            String?
  phone               String?
  email               String?
  notes               String?
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  addresses           CustomerAddress[]
  brand               Brand                @relation(fields: [brandId], references: [id])
  orders              Order[]
  Reservation         Reservation[]
  loyaltyAccount      CustomerLoyalty?
  loyaltyTransactions LoyaltyTransaction[]
  carts               Cart[]
  campaignAudiences   CampaignAudience[]
  campaignEngagements CampaignEngagement[]
  reviews             Review[]
  storeCredits        StoreCredit[]

  @@index([brandId])
  @@index([phone])
  @@index([email])
  @@map("customers")
}

model CustomerAddress {
  id         String   @id @default(uuid())
  customerId String
  label      String?
  line1      String
  line2      String?
  city       String?
  state      String?
  postalCode String?
  country    String?
  customer   Customer @relation(fields: [customerId], references: [id])

  @@index([customerId])
  @@map("customer_addresses")
}

model Order {
  id                      String                   @id @default(uuid())
  brandId                 String
  branchId                String
  tableId                 String?
  customerId              String?
  total                   Decimal                  @default(0) @db.Decimal(12, 2)
  createdAt               DateTime                 @default(now())
  createdById             String?
  closedAt                DateTime?
  covers                  Int?
  discount                Decimal                  @default(0) @db.Decimal(12, 2)
  notes                   String?
  paidTotal               Decimal                  @default(0) @db.Decimal(12, 2)
  service                 Decimal                  @default(0) @db.Decimal(12, 2)
  subtotal                Decimal                  @default(0) @db.Decimal(12, 2)
  tax                     Decimal                  @default(0) @db.Decimal(12, 2)
  tip                     Decimal                  @default(0) @db.Decimal(12, 2)
  type                    OrderType                @default(DINE_IN)
  status                  OrderStatus              @default(DRAFT)
  waiterId                String?
  billType                BillType                 @default(FINE_DINE)
  // Online ordering fields
  orderNumber             String?                  @unique
  isOnlineOrder           Boolean                  @default(false)
  customerName            String?
  customerEmail           String?
  customerPhone           String?
  deliveryAddress         Json?
  deliveryFee             Decimal                  @default(0) @db.Decimal(12, 2)
  paymentStatus           PaymentStatus?           @default(PENDING)
  paymentIntentId         String?                  @unique
  paymentMethod           String?
  transactionId           String?
  paidAt                  DateTime?
  specialInstructions     String?
  estimatedTime           Int?
  scheduledFor            DateTime?
  completedAt             DateTime?
  canceledAt              DateTime?
  cancelReason            String?
  KitchenTicket           KitchenTicket[]
  items                   OrderItem[]
  logs                    OrderLog[]
  taxes                   OrderTax[]
  branch                  Branch                   @relation(fields: [branchId], references: [id])
  brand                   Brand                    @relation(fields: [brandId], references: [id])
  createdBy               User?                    @relation("OrderCreatedBy", fields: [createdById], references: [id])
  customer                Customer?                @relation(fields: [customerId], references: [id])
  table                   Table?                   @relation(fields: [tableId], references: [id])
  waiter                  User?                    @relation("OrderWaiter", fields: [waiterId], references: [id])
  payments                Payment[]
  PromoRedemption         PromoRedemption[]
  Tip                     Tip[]
  walletTransactions      WalletTransaction[]
  reviews                 Review[]
  giftCardTransactions    GiftCardTransaction[]
  storeCreditTransactions StoreCreditTransaction[]
  deliveryOrder           DeliveryOrder?

  @@index([brandId])
  @@index([branchId])
  @@index([status])
  @@index([type])
  @@index([isOnlineOrder])
  @@index([paymentStatus])
  @@index([orderNumber])
  @@map("orders")
}

model OrderItem {
  id        String              @id @default(uuid())
  orderId   String
  variantId String?
  quantity  Int
  basePrice Decimal             @db.Decimal(12, 2)
  isVoided  Boolean             @default(false)
  itemId    String
  linePrice Decimal             @db.Decimal(12, 2)
  notes     String?
  routeToId String?
  tickets   KitchenTicketItem[]
  modifiers OrderItemModifier[]
  item      MenuItem            @relation(fields: [itemId], references: [id])
  order     Order               @relation(fields: [orderId], references: [id])
  routeTo   KitchenStation?     @relation(fields: [routeToId], references: [id])
  variant   ItemVariant?        @relation(fields: [variantId], references: [id])

  @@index([orderId])
  @@index([itemId])
  @@index([variantId])
  @@map("order_items")
}

model OrderItemModifier {
  id          String         @id @default(uuid())
  orderItemId String
  optionId    String
  price       Decimal        @db.Decimal(12, 2)
  option      ModifierOption @relation(fields: [optionId], references: [id])
  orderItem   OrderItem      @relation(fields: [orderItemId], references: [id])

  @@index([orderItemId])
  @@index([optionId])
  @@map("order_item_modifiers")
}

model OrderLog {
  id        String      @id @default(uuid())
  orderId   String
  status    OrderStatus
  message   String?
  userId    String?
  createdAt DateTime    @default(now())
  order     Order       @relation(fields: [orderId], references: [id])
  user      User?       @relation(fields: [userId], references: [id])

  @@index([orderId])
  @@index([status])
  @@map("order_logs")
}

model Payment {
  id        String           @id @default(uuid())
  brandId   String
  branchId  String
  orderId   String
  sessionId String?
  method    PaymentMethod
  amount    Decimal          @db.Decimal(12, 2)
  tipAmount Decimal          @default(0) @db.Decimal(12, 2)
  reference String?
  metadata  Json?
  createdAt DateTime         @default(now())
  refunds   PaymentRefund[]
  branch    Branch           @relation(fields: [branchId], references: [id])
  brand     Brand            @relation(fields: [brandId], references: [id])
  order     Order            @relation(fields: [orderId], references: [id])
  session   RegisterSession? @relation(fields: [sessionId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([orderId])
  @@map("payments")
}

model PaymentRefund {
  id        String   @id @default(uuid())
  paymentId String
  amount    Decimal  @db.Decimal(12, 2)
  reason    String?
  createdAt DateTime @default(now())
  payment   Payment  @relation(fields: [paymentId], references: [id])

  @@index([paymentId])
  @@map("payment_refunds")
}

model OrderTax {
  id        String  @id @default(uuid())
  orderId   String
  taxRateId String
  name      String
  ratePct   Decimal @db.Decimal(5, 2)
  amount    Decimal @db.Decimal(12, 2)
  order     Order   @relation(fields: [orderId], references: [id])
  taxRate   TaxRate @relation(fields: [taxRateId], references: [id])

  @@index([orderId])
  @@index([taxRateId])
  @@map("order_taxes")
}

model KitchenStation {
  id            String          @id @default(uuid())
  brandId       String
  branchId      String
  name          String
  isActive      Boolean         @default(true)
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  itemRoutes    ItemRoute[]
  branch        Branch          @relation(fields: [branchId], references: [id])
  brand         Brand           @relation(fields: [brandId], references: [id])
  tickets       KitchenTicket[]
  OrderItem     OrderItem[]
  variantRoutes VariantRoute[]

  @@unique([branchId, name])
  @@index([brandId])
  @@index([branchId])
  @@map("kitchen_stations")
}

model ItemRoute {
  stationId String
  itemId    String
  item      MenuItem       @relation(fields: [itemId], references: [id])
  station   KitchenStation @relation(fields: [stationId], references: [id])

  @@id([stationId, itemId])
  @@map("item_routes")
}

model VariantRoute {
  stationId String
  variantId String
  station   KitchenStation @relation(fields: [stationId], references: [id])
  variant   ItemVariant    @relation(fields: [variantId], references: [id])

  @@id([stationId, variantId])
  @@map("variant_routes")
}

model KitchenTicket {
  id             String              @id @default(uuid())
  brandId        String
  branchId       String
  orderId        String
  stationId      String
  status         KitchenTicketStatus @default(NEW)
  priority       Int                 @default(0) // Higher number = higher priority
  estimatedTime  Int? // Estimated prep time in minutes
  acceptedAt     DateTime? // When kitchen accepted the ticket
  startedAt      DateTime? // When prep started
  readyAt        DateTime? // When item was ready
  servedAt       DateTime? // When item was served
  bumpedAt       DateTime? // When ticket was bumped/cleared
  actualPrepTime Int? // Actual time taken (in minutes)
  delayReason    String? // If delayed, reason
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt
  items          KitchenTicketItem[]
  branch         Branch              @relation(fields: [branchId], references: [id])
  brand          Brand               @relation(fields: [brandId], references: [id])
  order          Order               @relation(fields: [orderId], references: [id])
  station        KitchenStation      @relation(fields: [stationId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([orderId])
  @@index([stationId])
  @@index([status])
  @@index([priority])
  @@map("kitchen_tickets")
}

model KitchenTicketItem {
  id          String              @id @default(uuid())
  ticketId    String
  orderItemId String
  status      KitchenTicketStatus @default(NEW)
  orderItem   OrderItem           @relation(fields: [orderItemId], references: [id])
  ticket      KitchenTicket       @relation(fields: [ticketId], references: [id])

  @@index([ticketId])
  @@index([orderItemId])
  @@map("kitchen_ticket_items")
}

model Printer {
  id        String      @id @default(uuid())
  brandId   String
  branchId  String
  name      String
  type      PrinterType @default(RECEIPT)
  deviceUri String
  isActive  Boolean     @default(true)
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
  jobs      PrintJob[]
  branch    Branch      @relation(fields: [branchId], references: [id])
  brand     Brand       @relation(fields: [brandId], references: [id])

  @@unique([branchId, name])
  @@index([brandId])
  @@index([branchId])
  @@map("printers")
}

model PrintJob {
  id        String    @id @default(uuid())
  brandId   String
  branchId  String
  printerId String
  payload   Json
  status    String    @default("QUEUED")
  createdAt DateTime  @default(now())
  sentAt    DateTime?
  branch    Branch    @relation(fields: [branchId], references: [id])
  brand     Brand     @relation(fields: [brandId], references: [id])
  printer   Printer   @relation(fields: [printerId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([printerId])
  @@map("print_jobs")
}

model Reservation {
  id         String            @id @default(uuid())
  brandId    String
  branchId   String
  tableId    String?
  customerId String?
  status     ReservationStatus @default(PENDING)
  covers     Int
  reservedAt DateTime
  notes      String?
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt
  branch     Branch            @relation(fields: [branchId], references: [id])
  brand      Brand             @relation(fields: [brandId], references: [id])
  customer   Customer?         @relation(fields: [customerId], references: [id])
  table      Table?            @relation(fields: [tableId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([reservedAt])
  @@map("reservations")
}

model WaitlistEntry {
  id        String   @id @default(uuid())
  brandId   String
  branchId  String
  name      String
  phone     String?
  covers    Int
  notes     String?
  status    String   @default("WAITING")
  createdAt DateTime @default(now())
  branch    Branch   @relation(fields: [branchId], references: [id])
  brand     Brand    @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@map("waitlist")
}

model Tip {
  id         String    @id @default(cuid())
  brandId    String
  branchId   String
  orderId    String?
  registerId String?
  staffId    String?
  amount     Decimal   @db.Decimal(12, 2)
  note       String?
  createdAt  DateTime  @default(now())
  method     TipMethod @default(CASH)
  type       TipType   @default(DIRECT)
  branch     Branch    @relation(fields: [branchId], references: [id])
  brand      Brand     @relation(fields: [brandId], references: [id])
  order      Order?    @relation(fields: [orderId], references: [id])
  staff      User?     @relation(fields: [staffId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([orderId])
  @@index([registerId])
  @@index([staffId])
  @@map("tips")
}

model TipSettlement {
  id          String          @id @default(cuid())
  brandId     String
  branchId    String
  registerId  String?
  date        DateTime        @default(now())
  total       Decimal
  rule        String
  createdAt   DateTime        @default(now())
  allocations TipAllocation[]
  branch      Branch          @relation(fields: [branchId], references: [id])
  brand       Brand           @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([registerId])
  @@map("tip_settlements")
}

model TipAllocation {
  id           String        @id @default(cuid())
  settlementId String
  staffId      String
  amount       Decimal
  createdAt    DateTime      @default(now())
  settlement   TipSettlement @relation(fields: [settlementId], references: [id])
  staff        User          @relation(fields: [staffId], references: [id])

  @@index([settlementId])
  @@index([staffId])
  @@map("tip_allocations")
}

model Promotion {
  id             String            @id @default(uuid())
  brandId        String
  code           String            @unique
  name           String
  type           DiscountType
  value          Decimal           @db.Decimal(7, 2)
  startsAt       DateTime?
  endsAt         DateTime?
  minSubtotal    Decimal?          @db.Decimal(12, 2)
  maxRedemptions Int?
  timesRedeemed  Int               @default(0)
  isActive       Boolean           @default(true)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  redemptions    PromoRedemption[]
  brand          Brand             @relation(fields: [brandId], references: [id])

  @@index([brandId, isActive])
  @@map("promotions")
}

model PromoRedemption {
  id          String    @id @default(uuid())
  promotionId String
  orderId     String
  amount      Decimal   @db.Decimal(12, 2)
  createdAt   DateTime  @default(now())
  order       Order     @relation(fields: [orderId], references: [id])
  promotion   Promotion @relation(fields: [promotionId], references: [id])

  @@unique([promotionId, orderId])
  @@index([orderId])
  @@map("promo_redemptions")
}

model DemoRequest {
  id         String            @id @default(uuid())
  email      String            @unique
  firstName  String?
  lastName   String?
  company    String?
  message    String?
  status     DemoRequestStatus @default(PENDING)
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt
  approvedAt DateTime?
  phone      String?
  code       RegistrationCode?

  @@map("demo_requests")
}

model RegistrationCode {
  id            String       @id @default(uuid())
  code          String       @unique
  email         String
  isUsed        Boolean      @default(false)
  expiresAt     DateTime
  createdAt     DateTime     @default(now())
  demoRequestId String?      @unique
  demoRequest   DemoRequest? @relation(fields: [demoRequestId], references: [id])

  @@map("registration_codes")
}

model PasswordResetToken {
  id        String   @id @default(uuid())
  email     String
  token     String   @unique
  isUsed    Boolean  @default(false)
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@index([email])
  @@map("password_reset_tokens")
}

model EmployeeProfile {
  id               String    @id @default(uuid())
  userId           String    @unique
  brandId          String
  employeeNumber   String?   @unique
  payType          PayType   @default(HOURLY)
  hourlyRate       Decimal?  @db.Decimal(10, 2)
  salaryAmount     Decimal?  @db.Decimal(12, 2)
  overtimeRate     Decimal?  @db.Decimal(10, 2)
  hireDate         DateTime?
  terminationDate  DateTime?
  isActive         Boolean   @default(true)
  taxId            String?
  bankAccount      String?
  emergencyContact String?
  emergencyPhone   String?
  notes            String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  brand            Brand     @relation(fields: [brandId], references: [id])
  user             User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([brandId])
  @@index([userId])
  @@map("employee_profiles")
}

model ShiftType {
  id            String   @id @default(uuid())
  name          String
  brandId       String
  branchId      String?
  startTime     String
  endTime       String
  breakDuration Int      @default(0)
  color         String?
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  shifts        Shift[]
  branch        Branch?  @relation(fields: [branchId], references: [id])
  brand         Brand    @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@map("shift_types")
}

model Shift {
  id             String       @id @default(uuid())
  brandId        String
  branchId       String
  userId         String
  shiftTypeId    String?
  scheduledStart DateTime
  scheduledEnd   DateTime
  actualStart    DateTime?
  actualEnd      DateTime?
  breakMinutes   Int          @default(0)
  status         ShiftStatus  @default(SCHEDULED)
  notes          String?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  attendance     Attendance[]
  branch         Branch       @relation(fields: [branchId], references: [id])
  brand          Brand        @relation(fields: [brandId], references: [id])
  shiftType      ShiftType?   @relation(fields: [shiftTypeId], references: [id])
  user           User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([brandId])
  @@index([branchId])
  @@index([userId])
  @@index([scheduledStart])
  @@map("shifts")
}

model Attendance {
  id         String           @id @default(uuid())
  shiftId    String
  userId     String
  brandId    String
  branchId   String
  clockIn    DateTime
  clockOut   DateTime?
  breakStart DateTime?
  breakEnd   DateTime?
  totalBreak Int              @default(0)
  status     AttendanceStatus @default(CLOCKED_IN)
  notes      String?
  ipAddress  String?
  location   String?
  createdAt  DateTime         @default(now())
  updatedAt  DateTime         @updatedAt
  branch     Branch           @relation(fields: [branchId], references: [id])
  brand      Brand            @relation(fields: [brandId], references: [id])
  shift      Shift            @relation(fields: [shiftId], references: [id], onDelete: Cascade)
  user       User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([brandId])
  @@index([branchId])
  @@index([userId])
  @@index([shiftId])
  @@index([clockIn])
  @@map("attendance")
}

model PayrollPeriod {
  id        String           @id @default(uuid())
  brandId   String
  branchId  String?
  startDate DateTime
  endDate   DateTime
  frequency PayrollFrequency @default(MONTHLY)
  status    PayrollStatus    @default(DRAFT)
  notes     String?
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt
  payrolls  Payroll[]
  branch    Branch?          @relation(fields: [branchId], references: [id])
  brand     Brand            @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([branchId])
  @@index([startDate, endDate])
  @@map("payroll_periods")
}

model Payroll {
  id              String        @id @default(uuid())
  periodId        String
  userId          String
  brandId         String
  branchId        String
  regularHours    Decimal       @default(0) @db.Decimal(8, 2)
  overtimeHours   Decimal       @default(0) @db.Decimal(8, 2)
  grossPay        Decimal       @db.Decimal(12, 2)
  totalDeductions Decimal       @default(0) @db.Decimal(12, 2)
  totalBonuses    Decimal       @default(0) @db.Decimal(12, 2)
  netPay          Decimal       @db.Decimal(12, 2)
  status          PayrollStatus @default(DRAFT)
  paidAt          DateTime?
  notes           String?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  items           PayrollItem[]
  branch          Branch        @relation(fields: [branchId], references: [id])
  brand           Brand         @relation(fields: [brandId], references: [id])
  period          PayrollPeriod @relation(fields: [periodId], references: [id], onDelete: Cascade)
  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([periodId, userId])
  @@index([brandId])
  @@index([branchId])
  @@index([userId])
  @@index([periodId])
  @@map("payrolls")
}

model PayrollItem {
  id          String          @id @default(uuid())
  payrollId   String
  type        PayrollItemType
  description String
  amount      Decimal         @db.Decimal(12, 2)
  quantity    Decimal?        @db.Decimal(8, 2)
  rate        Decimal?        @db.Decimal(10, 2)
  createdAt   DateTime        @default(now())
  payroll     Payroll         @relation(fields: [payrollId], references: [id], onDelete: Cascade)

  @@index([payrollId])
  @@map("payroll_items")
}

enum Role {
  SUPER_ADMIN
  BRAND_OWNER
  BRAND_ADMIN
  BRANCH_MANAGER
  STAFF
}

enum InvoiceStatus {
  PENDING
  PAID
  FAILED
  REFUNDED
  VOID
}

enum SubscriptionStatus {
  ACTIVE
  TRIALING
  PAST_DUE
  CANCELED
  EXPIRED
}

enum PaymentProvider {
  STRIPE
  POLAR
}

enum BillType {
  FINE_DINE
  QUICK_BILL
}

enum StockTxType {
  PURCHASE
  ADJUSTMENT
  WASTAGE
  TRANSFER
  SALE
  RETURN
}

enum POStatus {
  DRAFT
  SENT
  RECEIVED
  PARTIAL
  CANCELLED
}

enum TableStatus {
  AVAILABLE
  OCCUPIED
  RESERVED
  OUT_OF_SERVICE
}

enum RegisterStatus {
  OPEN
  CLOSED
}

enum SessionStatus {
  OPEN
  CLOSED
  CANCELLED
}

enum MovementType {
  SALE
  REFUND
  PAID_IN
  PAID_OUT
  ADJUSTMENT
}

enum TaxScope {
  BRAND
  BRANCH
}

enum DiscountType {
  PERCENT
  AMOUNT
}

enum OrderType {
  DINE_IN
  TAKEAWAY
  DELIVERY
  ONLINE
}

enum OrderStatus {
  DRAFT
  OPEN
  CONFIRMED
  IN_PROGRESS
  PREPARING
  READY
  OUT_FOR_DELIVERY
  DELIVERED
  SERVED
  PART_PAID
  PAID
  COMPLETED
  CANCELLED
  REFUNDED
}

enum KitchenTicketStatus {
  NEW
  ACCEPTED
  PREPARING
  READY
  SERVED
  VOIDED
}

enum PaymentMethod {
  CASH
  CARD
  UPI
  STRIPE
  PAYSTACK
  FLUTTERWAVE
  OTHER
}

enum ReservationStatus {
  PENDING
  CONFIRMED
  SEATED
  CANCELLED
  NO_SHOW
}

enum PrinterType {
  RECEIPT
  KITCHEN
}

enum StockTransferStatus {
  PENDING
  IN_TRANSIT
  COMPLETED
  CANCELLED
}

enum TipMethod {
  CASH
  CARD
  OTHER
}

enum TipType {
  DIRECT
  POOLED
  BRANCH
}

enum TipSettlementRule {
  EQUAL
  HOURS
  SALES
}

enum WaitlistStatus {
  WAITING
  NOTIFIED
  SEATED
  LEFT
}

enum PrintJobStatus {
  QUEUED
  SENT
  FAILED
}

enum DemoRequestStatus {
  PENDING
  APPROVED
  REJECTED
}

enum ShiftStatus {
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  NO_SHOW
}

enum AttendanceStatus {
  CLOCKED_IN
  ON_BREAK
  CLOCKED_OUT
}

enum PayrollStatus {
  DRAFT
  PENDING_APPROVAL
  APPROVED
  PAID
  CANCELLED
}

enum PayType {
  HOURLY
  SALARY
  DAILY
}

enum PayrollFrequency {
  WEEKLY
  BI_WEEKLY
  MONTHLY
  SEMI_MONTHLY
}

enum PayrollItemType {
  REGULAR_HOURS
  OVERTIME
  BONUS
  DEDUCTION
  COMMISSION
  TIPS
  ADJUSTMENT
}

model LoyaltyProgram {
  id                  String               @id @default(uuid())
  brandId             String
  name                String
  description         String?
  pointsPerCurrency   Decimal              @db.Decimal(10, 2)
  currencyPerPoint    Decimal              @db.Decimal(10, 2)
  minRedemptionPoints Int                  @default(100)
  expiryDays          Int?
  isActive            Boolean              @default(true)
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  brand               Brand                @relation(fields: [brandId], references: [id])
  tiers               LoyaltyTier[]
  customers           CustomerLoyalty[]
  transactions        LoyaltyTransaction[]
  rewards             LoyaltyReward[]

  @@index([brandId])
  @@map("loyalty_programs")
}

model LoyaltyTier {
  id         String            @id @default(uuid())
  programId  String
  name       String
  minPoints  Int
  benefits   Json?
  multiplier Decimal           @default(1.0) @db.Decimal(3, 2)
  color      String?
  sortOrder  Int               @default(0)
  createdAt  DateTime          @default(now())
  updatedAt  DateTime          @updatedAt
  program    LoyaltyProgram    @relation(fields: [programId], references: [id], onDelete: Cascade)
  customers  CustomerLoyalty[]

  @@index([programId])
  @@map("loyalty_tiers")
}

model CustomerLoyalty {
  id             String         @id @default(uuid())
  customerId     String         @unique
  programId      String
  tierId         String?
  points         Int            @default(0)
  lifetimePoints Int            @default(0)
  lifetimeSpent  Decimal        @default(0) @db.Decimal(12, 2)
  joinedAt       DateTime       @default(now())
  lastActivityAt DateTime       @default(now())
  updatedAt      DateTime       @updatedAt
  customer       Customer       @relation(fields: [customerId], references: [id], onDelete: Cascade)
  program        LoyaltyProgram @relation(fields: [programId], references: [id])
  tier           LoyaltyTier?   @relation(fields: [tierId], references: [id])

  @@index([customerId])
  @@index([programId])
  @@map("customer_loyalty")
}

model LoyaltyTransaction {
  id          String                 @id @default(uuid())
  customerId  String
  programId   String
  orderId     String?
  rewardId    String?
  type        LoyaltyTransactionType
  points      Int
  description String?
  createdAt   DateTime               @default(now())
  expiresAt   DateTime?
  customer    Customer               @relation(fields: [customerId], references: [id])
  program     LoyaltyProgram         @relation(fields: [programId], references: [id])
  reward      LoyaltyReward?         @relation(fields: [rewardId], references: [id])

  @@index([customerId])
  @@index([programId])
  @@index([orderId])
  @@map("loyalty_transactions")
}

model LoyaltyReward {
  id             String               @id @default(uuid())
  programId      String
  name           String
  description    String?
  pointsCost     Int
  rewardType     LoyaltyRewardType
  rewardValue    Decimal?             @db.Decimal(12, 2)
  itemId         String?
  isActive       Boolean              @default(true)
  maxRedemptions Int?
  validFrom      DateTime?
  validUntil     DateTime?
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  program        LoyaltyProgram       @relation(fields: [programId], references: [id], onDelete: Cascade)
  transactions   LoyaltyTransaction[]

  @@index([programId])
  @@index([isActive])
  @@map("loyalty_rewards")
}

enum LoyaltyTransactionType {
  EARNED
  REDEEMED
  EXPIRED
  ADJUSTED
  BONUS
}

enum LoyaltyRewardType {
  DISCOUNT_PERCENT
  DISCOUNT_AMOUNT
  FREE_ITEM
  VOUCHER
}

// Online Ordering Models
model OnlineMenu {
  id        String   @id @default(uuid())
  brandId   String
  branchId  String?
  isActive  Boolean  @default(true)
  qrCode    String? // QR code image URL
  urlSlug   String   @unique // e.g., "restaurant-name-branch"
  customUrl String? // Custom domain if restaurant has one
  settings  Json? // Menu display settings, colors, logo, etc.
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  brand     Brand    @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([urlSlug])
  @@map("online_menus")
}

model Cart {
  id         String     @id @default(uuid())
  sessionId  String     @unique // For guest users
  customerId String? // For logged-in customers
  brandId    String
  branchId   String?
  items      CartItem[]
  expiresAt  DateTime // Auto-delete after 24 hours
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  customer   Customer?  @relation(fields: [customerId], references: [id])

  @@index([sessionId])
  @@index([customerId])
  @@index([expiresAt])
  @@map("carts")
}

model CartItem {
  id        String       @id @default(uuid())
  cartId    String
  itemId    String
  variantId String?
  quantity  Int
  basePrice Decimal      @db.Decimal(12, 2)
  notes     String?
  modifiers Json? // Array of selected modifiers with prices
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  cart      Cart         @relation(fields: [cartId], references: [id], onDelete: Cascade)
  item      MenuItem     @relation(fields: [itemId], references: [id])
  variant   ItemVariant? @relation(fields: [variantId], references: [id])

  @@index([cartId])
  @@index([itemId])
  @@map("cart_items")
}

model RestaurantWallet {
  id                String              @id @default(uuid())
  brandId           String              @unique
  branchId          String?             @unique
  balance           Decimal             @default(0) @db.Decimal(12, 2)
  pendingBalance    Decimal             @default(0) @db.Decimal(12, 2) // Pending settlements
  totalEarned       Decimal             @default(0) @db.Decimal(12, 2)
  totalWithdrawn    Decimal             @default(0) @db.Decimal(12, 2)
  currency          String              @default("USD")
  stripeAccountId   String?             @unique // Stripe Connect account
  isActive          Boolean             @default(true)
  autoPayoutEnabled Boolean             @default(false)
  minPayoutAmount   Decimal             @default(100) @db.Decimal(12, 2)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  transactions      WalletTransaction[]
  payouts           Payout[]
  bankAccounts      BankAccount[]

  @@index([brandId])
  @@index([branchId])
  @@map("restaurant_wallets")
}

model WalletTransaction {
  id            String                @id @default(uuid())
  walletId      String
  orderId       String?
  type          WalletTransactionType
  amount        Decimal               @db.Decimal(12, 2)
  balanceBefore Decimal               @db.Decimal(12, 2)
  balanceAfter  Decimal               @db.Decimal(12, 2)
  status        TransactionStatus     @default(PENDING)
  description   String?
  metadata      Json?
  reference     String?               @unique
  payoutId      String?
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
  wallet        RestaurantWallet      @relation(fields: [walletId], references: [id])
  order         Order?                @relation(fields: [orderId], references: [id])
  payout        Payout?               @relation(fields: [payoutId], references: [id])

  @@index([walletId])
  @@index([orderId])
  @@index([type])
  @@index([status])
  @@index([createdAt])
  @@map("wallet_transactions")
}

model Payout {
  id             String              @id @default(uuid())
  walletId       String
  bankAccountId  String?
  amount         Decimal             @db.Decimal(12, 2)
  currency       String
  status         PayoutStatus        @default(PENDING)
  method         PayoutMethod        @default(BANK_TRANSFER)
  reference      String?             @unique
  stripePayoutId String?             @unique
  failureReason  String?
  requestedAt    DateTime            @default(now())
  processedAt    DateTime?
  completedAt    DateTime?
  failedAt       DateTime?
  metadata       Json?
  createdAt      DateTime            @default(now())
  updatedAt      DateTime            @updatedAt
  wallet         RestaurantWallet    @relation(fields: [walletId], references: [id])
  bankAccount    BankAccount?        @relation(fields: [bankAccountId], references: [id])
  transactions   WalletTransaction[]

  @@index([walletId])
  @@index([status])
  @@index([requestedAt])
  @@map("payouts")
}

model BankAccount {
  id            String           @id @default(uuid())
  walletId      String
  accountName   String
  accountNumber String
  bankName      String
  bankCode      String?
  routingNumber String? // For US banks
  swiftCode     String? // For international
  iban          String? // For international
  currency      String           @default("USD")
  isDefault     Boolean          @default(false)
  isVerified    Boolean          @default(false)
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  wallet        RestaurantWallet @relation(fields: [walletId], references: [id], onDelete: Cascade)
  payouts       Payout[]

  @@index([walletId])
  @@map("bank_accounts")
}

enum PaymentStatus {
  PENDING
  PROCESSING
  SUCCEEDED
  FAILED
  REFUNDED
  PARTIALLY_REFUNDED
}

enum WalletTransactionType {
  CREDIT // Money coming in from orders
  DEBIT // Money going out (payouts, fees)
  REFUND // Refund to customer
  FEE // Platform/processing fee
  ADJUSTMENT // Manual adjustment
  PAYOUT // Transfer to bank
}

enum TransactionStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  CANCELLED
}

enum PayoutStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  CANCELLED
}

enum PayoutMethod {
  BANK_TRANSFER
  STRIPE_CONNECT
  MANUAL
}

// ============================================
// Marketing Campaign Models
// ============================================

model Campaign {
  id             String               @id @default(uuid())
  brandId        String
  name           String
  description    String?
  type           CampaignType
  status         CampaignStatus       @default(DRAFT)
  channel        CampaignChannel
  startDate      DateTime?
  endDate        DateTime?
  budget         Decimal?             @db.Decimal(12, 2)
  targetAudience Json? // Flexible targeting criteria
  content        Json // Campaign content (email, sms, push notification content)
  imageUrl       String?
  callToAction   String?
  link           String?
  promoCode      String?
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  brand          Brand                @relation(fields: [brandId], references: [id], onDelete: Cascade)
  metrics        CampaignMetrics?
  audiences      CampaignAudience[]
  engagements    CampaignEngagement[]

  @@index([brandId])
  @@index([status])
  @@index([type])
  @@index([startDate])
  @@map("campaigns")
}

model CampaignAudience {
  id              String    @id @default(uuid())
  campaignId      String
  customerId      String?
  email           String?
  phone           String?
  segmentCriteria Json? // How they were selected
  sentAt          DateTime?
  deliveredAt     DateTime?
  openedAt        DateTime?
  clickedAt       DateTime?
  convertedAt     DateTime?
  unsubscribedAt  DateTime?
  createdAt       DateTime  @default(now())
  campaign        Campaign  @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  customer        Customer? @relation(fields: [customerId], references: [id], onDelete: SetNull)

  @@index([campaignId])
  @@index([customerId])
  @@index([email])
  @@map("campaign_audiences")
}

model CampaignMetrics {
  id                String   @id @default(uuid())
  campaignId        String   @unique
  totalSent         Int      @default(0)
  totalDelivered    Int      @default(0)
  totalOpened       Int      @default(0)
  totalClicked      Int      @default(0)
  totalConverted    Int      @default(0)
  totalUnsubscribed Int      @default(0)
  totalRevenue      Decimal  @default(0) @db.Decimal(12, 2)
  uniqueOpens       Int      @default(0)
  uniqueClicks      Int      @default(0)
  bounceRate        Decimal? @db.Decimal(5, 2)
  conversionRate    Decimal? @db.Decimal(5, 2)
  roi               Decimal? @db.Decimal(10, 2) // Return on Investment
  updatedAt         DateTime @updatedAt
  campaign          Campaign @relation(fields: [campaignId], references: [id], onDelete: Cascade)

  @@index([campaignId])
  @@map("campaign_metrics")
}

model CampaignEngagement {
  id         String            @id @default(uuid())
  campaignId String
  customerId String?
  email      String?
  eventType  CampaignEventType
  eventData  Json? // Additional event information
  ipAddress  String?
  userAgent  String?
  createdAt  DateTime          @default(now())
  campaign   Campaign          @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  customer   Customer?         @relation(fields: [customerId], references: [id], onDelete: SetNull)

  @@index([campaignId])
  @@index([customerId])
  @@index([eventType])
  @@index([createdAt])
  @@map("campaign_engagements")
}

enum CampaignType {
  PROMOTIONAL // Discount, special offer
  ANNOUNCEMENT // New menu item, event
  LOYALTY_REWARD // Loyalty program promotions
  SEASONAL // Holiday, seasonal campaigns
  BRAND_AWARENESS // General brand promotion
  RE_ENGAGEMENT // Win back inactive customers
  PRODUCT_LAUNCH // New product introduction
  FEEDBACK // Request reviews or feedback
}

enum CampaignStatus {
  DRAFT // Being created
  SCHEDULED // Scheduled to run
  ACTIVE // Currently running
  PAUSED // Temporarily paused
  COMPLETED // Finished running
  CANCELLED // Cancelled before completion
}

enum CampaignChannel {
  EMAIL // Email marketing
  SMS // Text message
  PUSH // Push notification
  IN_APP // In-app message
  SOCIAL_MEDIA // Social media post
  QR_CODE // QR code campaign
  WEBSITE_BANNER // Website banner
}

enum CampaignEventType {
  SENT // Campaign sent
  DELIVERED // Successfully delivered
  OPENED // Email/message opened
  CLICKED // Link clicked
  CONVERTED // Made a purchase
  BOUNCED // Delivery failed
  UNSUBSCRIBED // Unsubscribed from list
  COMPLAINT // Marked as spam
}

// ============================================
// Reviews & Ratings System
// ============================================

model Review {
  id             String          @id @default(uuid())
  brandId        String
  customerId     String
  orderId        String?
  rating         Int // 1-5 stars
  title          String?
  comment        String?
  foodRating     Int? // 1-5 stars
  serviceRating  Int? // 1-5 stars
  ambianceRating Int? // 1-5 stars
  isVerified     Boolean         @default(false) // Verified purchase
  isPublished    Boolean         @default(true)
  isFlagged      Boolean         @default(false)
  flagReason     String?
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  brand          Brand           @relation(fields: [brandId], references: [id], onDelete: Cascade)
  customer       Customer        @relation(fields: [customerId], references: [id], onDelete: Cascade)
  order          Order?          @relation(fields: [orderId], references: [id], onDelete: SetNull)
  response       ReviewResponse?
  media          ReviewMedia[]

  @@index([brandId])
  @@index([customerId])
  @@index([orderId])
  @@index([rating])
  @@index([isPublished])
  @@index([createdAt])
  @@map("reviews")
}

model ReviewResponse {
  id        String   @id @default(uuid())
  reviewId  String   @unique
  message   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  review    Review   @relation(fields: [reviewId], references: [id], onDelete: Cascade)

  @@index([reviewId])
  @@map("review_responses")
}

model ReviewMedia {
  id        String    @id @default(uuid())
  reviewId  String
  type      MediaType
  url       String
  createdAt DateTime  @default(now())
  review    Review    @relation(fields: [reviewId], references: [id], onDelete: Cascade)

  @@index([reviewId])
  @@map("review_media")
}

enum MediaType {
  IMAGE
  VIDEO
}

// ============================================
// Gift Cards & Store Credit
// ============================================

model GiftCard {
  id             String                @id @default(uuid())
  brandId        String
  code           String                @unique
  initialAmount  Decimal               @db.Decimal(12, 2)
  balance        Decimal               @db.Decimal(12, 2)
  currency       String                @default("USD")
  status         GiftCardStatus        @default(ACTIVE)
  purchasedBy    String? // Customer ID
  recipientName  String?
  recipientEmail String?
  recipientPhone String?
  message        String?
  expiresAt      DateTime?
  createdAt      DateTime              @default(now())
  updatedAt      DateTime              @updatedAt
  brand          Brand                 @relation(fields: [brandId], references: [id], onDelete: Cascade)
  transactions   GiftCardTransaction[]

  @@index([brandId])
  @@index([code])
  @@index([status])
  @@index([expiresAt])
  @@map("gift_cards")
}

model GiftCardTransaction {
  id         String          @id @default(uuid())
  giftCardId String
  orderId    String?
  type       GiftCardTxnType
  amount     Decimal         @db.Decimal(12, 2)
  balance    Decimal         @db.Decimal(12, 2) // Balance after transaction
  note       String?
  createdAt  DateTime        @default(now())
  giftCard   GiftCard        @relation(fields: [giftCardId], references: [id], onDelete: Cascade)
  order      Order?          @relation(fields: [orderId], references: [id], onDelete: SetNull)

  @@index([giftCardId])
  @@index([orderId])
  @@index([createdAt])
  @@map("gift_card_transactions")
}

model StoreCredit {
  id           String                   @id @default(uuid())
  brandId      String
  customerId   String
  balance      Decimal                  @db.Decimal(12, 2)
  currency     String                   @default("USD")
  reason       String? // Refund, compensation, promotion
  expiresAt    DateTime?
  createdAt    DateTime                 @default(now())
  updatedAt    DateTime                 @updatedAt
  brand        Brand                    @relation(fields: [brandId], references: [id], onDelete: Cascade)
  customer     Customer                 @relation(fields: [customerId], references: [id], onDelete: Cascade)
  transactions StoreCreditTransaction[]

  @@unique([brandId, customerId])
  @@index([customerId])
  @@map("store_credits")
}

model StoreCreditTransaction {
  id            String             @id @default(uuid())
  storeCreditId String
  orderId       String?
  type          StoreCreditTxnType
  amount        Decimal            @db.Decimal(12, 2)
  balance       Decimal            @db.Decimal(12, 2)
  note          String?
  createdAt     DateTime           @default(now())
  storeCredit   StoreCredit        @relation(fields: [storeCreditId], references: [id], onDelete: Cascade)
  order         Order?             @relation(fields: [orderId], references: [id], onDelete: SetNull)

  @@index([storeCreditId])
  @@index([orderId])
  @@index([createdAt])
  @@map("store_credit_transactions")
}

enum GiftCardStatus {
  ACTIVE
  REDEEMED
  EXPIRED
  CANCELLED
}

enum GiftCardTxnType {
  PURCHASE
  REDEMPTION
  REFUND
  ADJUSTMENT
}

enum StoreCreditTxnType {
  CREDIT
  DEBIT
  REFUND
  ADJUSTMENT
  EXPIRATION
}

// ============================================
// Third-Party Delivery Integration
// ============================================

model DeliveryProvider {
  id            String                @id @default(uuid())
  name          String                @unique // UBER_EATS, DOORDASH, GRUBHUB
  displayName   String
  isActive      Boolean               @default(true)
  apiEndpoint   String?
  webhookSecret String?
  createdAt     DateTime              @default(now())
  updatedAt     DateTime              @updatedAt
  integrations  DeliveryIntegration[]

  @@map("delivery_providers")
}

model DeliveryIntegration {
  id          String           @id @default(uuid())
  brandId     String
  branchId    String?
  providerId  String
  isEnabled   Boolean          @default(true)
  credentials Json // Store encrypted API keys, tokens
  settings    Json? // Provider-specific settings
  lastSyncAt  DateTime?
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  brand       Brand            @relation(fields: [brandId], references: [id], onDelete: Cascade)
  provider    DeliveryProvider @relation(fields: [providerId], references: [id])
  orders      DeliveryOrder[]

  @@unique([brandId, providerId])
  @@index([brandId])
  @@index([providerId])
  @@map("delivery_integrations")
}

model DeliveryOrder {
  id                  String              @id @default(uuid())
  integrationId       String
  orderId             String              @unique // Our internal order ID
  externalOrderId     String // Provider's order ID
  provider            String // UBER_EATS, DOORDASH, etc.
  status              DeliveryOrderStatus
  customerName        String
  customerPhone       String?
  deliveryAddress     Json
  items               Json
  subtotal            Decimal             @db.Decimal(12, 2)
  deliveryFee         Decimal             @db.Decimal(12, 2)
  serviceFee          Decimal             @default(0) @db.Decimal(12, 2)
  tip                 Decimal             @default(0) @db.Decimal(12, 2)
  tax                 Decimal             @default(0) @db.Decimal(12, 2)
  total               Decimal             @db.Decimal(12, 2)
  commission          Decimal?            @db.Decimal(12, 2) // Platform commission
  estimatedPickup     DateTime?
  estimatedDelivery   DateTime?
  actualPickup        DateTime?
  actualDelivery      DateTime?
  driverName          String?
  driverPhone         String?
  specialInstructions String?
  rawData             Json? // Store complete webhook payload
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  integration         DeliveryIntegration @relation(fields: [integrationId], references: [id])
  order               Order               @relation(fields: [orderId], references: [id])

  @@index([integrationId])
  @@index([orderId])
  @@index([externalOrderId])
  @@index([status])
  @@index([createdAt])
  @@map("delivery_orders")
}

enum DeliveryOrderStatus {
  PENDING
  CONFIRMED
  PREPARING
  READY_FOR_PICKUP
  PICKED_UP
  IN_TRANSIT
  DELIVERED
  CANCELLED
  FAILED
}

// ============================================
// Settings System
// ============================================

model Settings {
  id       String  @id @default(uuid())
  brandId  String  @unique
  branchId String? @unique

  // Business Information
  businessName    String?
  businessAddress String?
  businessPhone   String?
  businessEmail   String?
  website         String?
  logo            String?

  // Business Hours
  businessHours Json? // { monday: { open: "09:00", close: "22:00", closed: false }, ... }
  timezone      String @default("UTC")

  // Payment Settings
  paymentSettings Json? // { defaultGateway: "stripe", allowCash: true, allowCard: true, ... }

  // Receipt Settings
  receiptSettings Json? // { showLogo: true, footerText: "Thank you!", showTax: true, ... }

  // Order Settings
  orderSettings Json? // { autoAccept: false, prepTime: 15, maxFutureOrders: 7, ... }

  // Notification Settings
  notifications Json? // { emailOrders: true, smsOrders: false, pushOrders: true, ... }

  // Tax Settings
  taxSettings Json? // { includeTax: false, defaultTaxRate: 0, ... }

  // Feature Flags
  features Json? // { onlineOrdering: true, reservations: true, loyalty: false, ... }

  // Email Settings
  emailSettings Json? // { smtpHost: "", smtpPort: 587, fromEmail: "", ... }

  // Other Settings
  currency   String @default("USD")
  language   String @default("en")
  dateFormat String @default("MM/DD/YYYY")
  timeFormat String @default("12h") // 12h or 24h

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([brandId])
  @@index([branchId])
  @@map("settings")
}
