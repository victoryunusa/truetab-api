{"level":"error","message":"TypeError: Cannot read properties of undefined (reading 'brandId')\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:9:18\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/auth.js:21:7\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at Route.dispatch (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:117:3)\n    at handle (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:435:11)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:295:15","service":"ehr-platform","timestamp":"2025-08-22T03:00:39.283Z"}
{"level":"error","message":"TypeError: Cannot read properties of undefined (reading 'branchId')\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:14:18\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/auth.js:21:7\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at Route.dispatch (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:117:3)\n    at handle (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:435:11)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:295:15","service":"ehr-platform","timestamp":"2025-08-22T03:01:21.524Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findMany')","ip":"::1","method":"GET","requestId":"2cebe669-af83-4f85-a28e-629023b162d7","stack":"TypeError: Cannot read properties of undefined (reading 'findMany')\n    at Object.list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.service.js:5:21)\n    at list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.controller.js:5:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/taxes","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T14:38:47.486Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.order.findMany()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/orders/order.service.js:17:23\n\n  14 async function list({ brandId, branchId, query }) {\n  15   const where = { brandId, branchId };\n  16   if (query?.status) where.status = query.status;\n→ 17   return prisma.order.findMany({\n         where: {\n           brandId: \"b0ad7a19-3583-449b-b1da-6e653508af0f\",\n           status: \"PENDING\",\n       +   branchId: {\n       +     equals: String | StringFieldRefInput,\n       +     in: String[] | ListStringFieldRefInput,\n       +     notIn: String[] | ListStringFieldRefInput,\n       +     lt: String | StringFieldRefInput,\n       +     lte: String | StringFieldRefInput,\n       +     gt: String | StringFieldRefInput,\n       +     gte: String | StringFieldRefInput,\n       +     contains: String | StringFieldRefInput,\n       +     startsWith: String | StringFieldRefInput,\n       +     endsWith: String | StringFieldRefInput,\n       +     mode: QueryMode,\n       +     not: String | NestedStringFilter\n       +   }\n         },\n         orderBy: {\n           createdAt: \"desc\"\n         },\n         include: {\n           items: {\n             include: {\n               modifiers: true,\n               item: true,\n               variant: true\n             }\n           },\n           payments: true,\n           taxes: true,\n           logs: true\n         }\n       })\n\nArgument `branchId` must not be null.","ip":"::1","method":"GET","requestId":"d99c5ed2-a990-4e73-9618-b5fe78b24164","stack":"PrismaClientValidationError: \nInvalid `prisma.order.findMany()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/orders/order.service.js:17:23\n\n  14 async function list({ brandId, branchId, query }) {\n  15   const where = { brandId, branchId };\n  16   if (query?.status) where.status = query.status;\n→ 17   return prisma.order.findMany({\n         where: {\n           brandId: \"b0ad7a19-3583-449b-b1da-6e653508af0f\",\n           status: \"PENDING\",\n       +   branchId: {\n       +     equals: String | StringFieldRefInput,\n       +     in: String[] | ListStringFieldRefInput,\n       +     notIn: String[] | ListStringFieldRefInput,\n       +     lt: String | StringFieldRefInput,\n       +     lte: String | StringFieldRefInput,\n       +     gt: String | StringFieldRefInput,\n       +     gte: String | StringFieldRefInput,\n       +     contains: String | StringFieldRefInput,\n       +     startsWith: String | StringFieldRefInput,\n       +     endsWith: String | StringFieldRefInput,\n       +     mode: QueryMode,\n       +     not: String | NestedStringFilter\n       +   }\n         },\n         orderBy: {\n           createdAt: \"desc\"\n         },\n         include: {\n           items: {\n             include: {\n               modifiers: true,\n               item: true,\n               variant: true\n             }\n           },\n           payments: true,\n           taxes: true,\n           logs: true\n         }\n       })\n\nArgument `branchId` must not be null.\n    at _n (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6926)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/orders/order.controller.js:15:16)","url":"/api/orders?status=PENDING&limit=20&offset=0","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T14:39:41.293Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findUnique')","ip":"::1","method":"GET","requestId":"b077b3b5-182f-4477-ab08-64b70db0af65","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at Object.getForBranch (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.service.js:5:31)\n    at get (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.controller.js:5:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/service-charge/d4fb6e2d-c1d1-4ed2-b692-dc4eceb509b0","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T19:50:37.763Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findUnique')","ip":"::1","method":"GET","requestId":"77212c8b-b840-4a51-9c7b-f7838c8ff5fe","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at Object.getForBranch (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.service.js:5:31)\n    at get (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.controller.js:5:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/service-charge/d4fb6e2d-c1d1-4ed2-b692-dc4eceb509b0","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T19:51:05.481Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'upsert')","ip":"::1","method":"POST","requestId":"cc8dfee6-98dd-41a1-a1b8-f98f22a4c71f","stack":"TypeError: Cannot read properties of undefined (reading 'upsert')\n    at Object.upsertForBranch (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.service.js:9:31)\n    at upsert (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.controller.js:16:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/service-charge/d4fb6e2d-c1d1-4ed2-b692-dc4eceb509b0","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T19:53:02.319Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.tip.findMany()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tips/tip.service.js:5:21\n\n  2 const prisma = new PrismaClient();\n  3 \n  4 async function list({ brandId, branchId }) {\n→ 5   return prisma.tip.findMany({\n        where: {\n          brandId: \"b0ad7a19-3583-449b-b1da-6e653508af0f\",\n      +   branchId: {\n      +     equals: String | StringFieldRefInput,\n      +     in: String[] | ListStringFieldRefInput,\n      +     notIn: String[] | ListStringFieldRefInput,\n      +     lt: String | StringFieldRefInput,\n      +     lte: String | StringFieldRefInput,\n      +     gt: String | StringFieldRefInput,\n      +     gte: String | StringFieldRefInput,\n      +     contains: String | StringFieldRefInput,\n      +     startsWith: String | StringFieldRefInput,\n      +     endsWith: String | StringFieldRefInput,\n      +     mode: QueryMode,\n      +     not: String | NestedStringFilter\n      +   }\n        },\n        orderBy: {\n          createdAt: \"desc\"\n        },\n        include: {\n          staff: true,\n          order: true\n        }\n      })\n\nArgument `branchId` must not be null.","ip":"::1","method":"GET","requestId":"46df61b8-1fbb-4cf8-824a-17278451e890","stack":"PrismaClientValidationError: \nInvalid `prisma.tip.findMany()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tips/tip.service.js:5:21\n\n  2 const prisma = new PrismaClient();\n  3 \n  4 async function list({ brandId, branchId }) {\n→ 5   return prisma.tip.findMany({\n        where: {\n          brandId: \"b0ad7a19-3583-449b-b1da-6e653508af0f\",\n      +   branchId: {\n      +     equals: String | StringFieldRefInput,\n      +     in: String[] | ListStringFieldRefInput,\n      +     notIn: String[] | ListStringFieldRefInput,\n      +     lt: String | StringFieldRefInput,\n      +     lte: String | StringFieldRefInput,\n      +     gt: String | StringFieldRefInput,\n      +     gte: String | StringFieldRefInput,\n      +     contains: String | StringFieldRefInput,\n      +     startsWith: String | StringFieldRefInput,\n      +     endsWith: String | StringFieldRefInput,\n      +     mode: QueryMode,\n      +     not: String | NestedStringFilter\n      +   }\n        },\n        orderBy: {\n          createdAt: \"desc\"\n        },\n        include: {\n          staff: true,\n          order: true\n        }\n      })\n\nArgument `branchId` must not be null.\n    at _n (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6926)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tips/tip.controller.js:5:16)","url":"/api/tips?startDate=2024-01-01&endDate=2024-12-31","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T19:53:32.124Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.tipSettlement.findMany()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tip-settlement/tip-settlement.service.js:61:31\n\n  58 }\n  59 \n  60 async function list({ brandId, branchId }) {\n→ 61   return prisma.tipSettlement.findMany({\n         where: {\n           brandId: \"b0ad7a19-3583-449b-b1da-6e653508af0f\",\n       +   branchId: {\n       +     equals: String | StringFieldRefInput,\n       +     in: String[] | ListStringFieldRefInput,\n       +     notIn: String[] | ListStringFieldRefInput,\n       +     lt: String | StringFieldRefInput,\n       +     lte: String | StringFieldRefInput,\n       +     gt: String | StringFieldRefInput,\n       +     gte: String | StringFieldRefInput,\n       +     contains: String | StringFieldRefInput,\n       +     startsWith: String | StringFieldRefInput,\n       +     endsWith: String | StringFieldRefInput,\n       +     mode: QueryMode,\n       +     not: String | NestedStringFilter\n       +   }\n         },\n         include: {\n           allocations: {\n             include: {\n               staff: true\n             }\n           }\n         },\n         orderBy: {\n           createdAt: \"desc\"\n         }\n       })\n\nArgument `branchId` must not be null.","ip":"::1","method":"GET","requestId":"e51c4be1-9d54-4803-8ca0-2d148cbd260c","stack":"PrismaClientValidationError: \nInvalid `prisma.tipSettlement.findMany()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tip-settlement/tip-settlement.service.js:61:31\n\n  58 }\n  59 \n  60 async function list({ brandId, branchId }) {\n→ 61   return prisma.tipSettlement.findMany({\n         where: {\n           brandId: \"b0ad7a19-3583-449b-b1da-6e653508af0f\",\n       +   branchId: {\n       +     equals: String | StringFieldRefInput,\n       +     in: String[] | ListStringFieldRefInput,\n       +     notIn: String[] | ListStringFieldRefInput,\n       +     lt: String | StringFieldRefInput,\n       +     lte: String | StringFieldRefInput,\n       +     gt: String | StringFieldRefInput,\n       +     gte: String | StringFieldRefInput,\n       +     contains: String | StringFieldRefInput,\n       +     startsWith: String | StringFieldRefInput,\n       +     endsWith: String | StringFieldRefInput,\n       +     mode: QueryMode,\n       +     not: String | NestedStringFilter\n       +   }\n         },\n         include: {\n           allocations: {\n             include: {\n               staff: true\n             }\n           }\n         },\n         orderBy: {\n           createdAt: \"desc\"\n         }\n       })\n\nArgument `branchId` must not be null.\n    at _n (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:29:1363)\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6926)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tip-settlement/tip-settlement.controller.js:18:16)","url":"/api/tip-settlement?limit=20&offset=0","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T20:22:02.203Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'create')","ip":"::1","method":"POST","requestId":"9b4c562a-17be-4b45-83ae-22d3c8190f0d","stack":"TypeError: Cannot read properties of undefined (reading 'create')\n    at Object.create (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.service.js:12:21)\n    at create (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.controller.js:16:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/taxes","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-25T20:44:48.461Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findMany')","ip":"::1","method":"GET","requestId":"a5bcea88-6bd5-4578-9a5e-480fc4a1db8c","stack":"TypeError: Cannot read properties of undefined (reading 'findMany')\n    at Object.list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.service.js:5:21)\n    at list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.controller.js:5:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/taxes","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-26T04:28:58.881Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findMany')","ip":"::1","method":"GET","requestId":"8e97aa9f-624c-43c2-b026-4bfc046fffd0","stack":"TypeError: Cannot read properties of undefined (reading 'findMany')\n    at Object.list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.service.js:5:21)\n    at list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/tax/tax.controller.js:5:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/taxes","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-26T04:29:25.752Z"}
{"level":"error","message":{"error":"Expected double-quoted property name in JSON at position 53 (line 4 column 1)","ip":"::1","method":"POST","requestId":"b8f88553-dafb-43fc-a00c-384d1ca97997","stack":"SyntaxError: Expected double-quoted property name in JSON at position 53 (line 4 column 1)\n    at JSON.parse (<anonymous>)\n    at parse (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/body-parser/lib/types/json.js:77:19)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/body-parser/lib/read.js:123:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/raw-body/index.js:238:16)\n    at done (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/raw-body/index.js:227:7)\n    at IncomingMessage.onEnd (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/raw-body/index.js:287:7)\n    at IncomingMessage.emit (node:events:518:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)","url":"/api/users/invite","userAgent":"PostmanRuntime/7.45.0"},"service":"truetab-api","timestamp":"2025-09-26T14:14:31.014Z"}
{"level":"error","message":{"error":"Expected double-quoted property name in JSON at position 70 (line 4 column 1)","ip":"::1","method":"POST","requestId":"86557674-3d00-428e-8947-fbe897577c62","stack":"SyntaxError: Expected double-quoted property name in JSON at position 70 (line 4 column 1)\n    at JSON.parse (<anonymous>)\n    at parse (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/body-parser/lib/types/json.js:77:19)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/body-parser/lib/read.js:123:18\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/raw-body/index.js:238:16)\n    at done (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/raw-body/index.js:227:7)\n    at IncomingMessage.onEnd (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/raw-body/index.js:287:7)\n    at IncomingMessage.emit (node:events:518:28)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)","url":"/api/branches","userAgent":"PostmanRuntime/7.48.0"},"service":"truetab-api","timestamp":"2025-09-26T23:03:11.918Z"}
{"level":"error","message":{"error":"Not allowed by CORS","ip":"::1","method":"OPTIONS","requestId":"d9f18f11-4bfd-4312-a688-b61065067563","stack":"Error: Not allowed by CORS\n    at origin (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/app.js:61:23)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:204:7)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:342:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:297:9\n    at processParams (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:582:12)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:291:5)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/express-rate-limit/dist/index.cjs:864:7","url":"/api/auth/login","userAgent":"Mozilla/5.0 (Linux; Android 13; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Mobile Safari/537.36"},"service":"truetab-api","timestamp":"2025-09-27T13:06:58.104Z"}
{"level":"error","message":{"error":"isProduction is not defined","ip":"::1","method":"GET","requestId":"7c1c307d-a810-419b-8f64-9ced5b2d5677","stack":"ReferenceError: isProduction is not defined\n    at origin (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/app.js:72:22)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:204:7)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:342:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:297:9\n    at processParams (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:582:12)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:291:5)\n    at cors (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:188:7)","url":"/","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"},"service":"truetab-api","timestamp":"2025-11-04T20:39:56.248Z"}
{"level":"error","message":{"error":"isProduction is not defined","ip":"::1","method":"GET","requestId":"66ea3e7e-0b5f-449b-9352-99a464831e9b","stack":"ReferenceError: isProduction is not defined\n    at origin (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/app.js:72:22)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:204:7)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:342:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:297:9\n    at processParams (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:582:12)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:291:5)\n    at cors (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:188:7)","url":"/favicon.ico","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"},"service":"truetab-api","timestamp":"2025-11-04T20:39:56.930Z"}
{"level":"error","message":{"error":"Not allowed by CORS","ip":"::1","method":"OPTIONS","requestId":"e04a92b9-e144-430e-8c8d-374c4580c38a","stack":"Error: Not allowed by CORS\n    at origin (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/app.js:61:23)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:204:7)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:342:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:297:9\n    at processParams (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:582:12)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:291:5)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/express-rate-limit/dist/index.cjs:864:7","url":"/api/auth/login","userAgent":"Mozilla/5.0 (iPhone; CPU iPhone OS 18_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1"},"service":"truetab-api","timestamp":"2025-11-04T20:43:08.065Z"}
{"level":"error","message":{"error":"Not allowed by CORS","ip":"::1","method":"OPTIONS","requestId":"4e027314-52de-4b04-9ab2-1d408117d7a8","stack":"Error: Not allowed by CORS\n    at origin (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/app.js:61:23)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:204:7)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:342:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:297:9\n    at processParams (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:582:12)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:291:5)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/express-rate-limit/dist/index.cjs:864:7","url":"/api/auth/login","userAgent":"Mozilla/5.0 (iPhone; CPU iPhone OS 18_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1"},"service":"truetab-api","timestamp":"2025-11-04T20:43:36.842Z"}
{"level":"error","message":{"error":"Not allowed by CORS","ip":"::1","method":"OPTIONS","requestId":"fa2fb608-000e-4265-bdd5-a4085f97477e","stack":"Error: Not allowed by CORS\n    at origin (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/app.js:61:23)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:219:13\n    at optionsCallback (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:199:9)\n    at corsMiddleware (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/cors/lib/index.js:204:7)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:342:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:297:9\n    at processParams (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:582:12)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:291:5)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/express-rate-limit/dist/index.cjs:864:7","url":"/api/auth/login","userAgent":"Mozilla/5.0 (iPhone; CPU iPhone OS 18_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.5 Mobile/15E148 Safari/604.1"},"service":"truetab-api","timestamp":"2025-11-04T20:43:38.376Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.","ip":"::1","method":"GET","requestId":"341d312e-68be-4b19-8a84-40a7c77a98df","stack":"PrismaClientKnownRequestError: \nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:7283)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:25","url":"/api/branches","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"},"service":"truetab-api","timestamp":"2025-11-08T20:00:11.430Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.","ip":"::1","method":"GET","requestId":"aaa8db9f-2aea-4e1f-9483-29e1a2e014c7","stack":"PrismaClientKnownRequestError: \nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:7283)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:25","url":"/api/branches","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36"},"service":"truetab-api","timestamp":"2025-11-08T20:00:16.443Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.","ip":"::1","method":"GET","requestId":"656831bd-422c-494e-a826-de807ccccdb2","stack":"PrismaClientInitializationError: \nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:7583)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:25","url":"/api/customers/","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36"},"service":"truetab-api","timestamp":"2025-11-10T10:05:19.066Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findFirst')","ip":"::1","method":"GET","requestId":"3aee7da0-3119-47b6-944c-5c39911b76be","stack":"TypeError: Cannot read properties of undefined (reading 'findFirst')\n    at Object.getOrCreateWallet (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/wallet.service.js:9:46)\n    at Object.getBankAccounts (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/bank-account.service.js:60:38)\n    at list (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/bank-account.controller.js:8:47)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:49:7","url":"/api/wallet/bank-accounts","userAgent":"PostmanRuntime/7.50.0"},"service":"truetab-api","timestamp":"2025-11-14T05:32:07.754Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findMany')","ip":"::1","method":"GET","requestId":"ddfd2002-d26f-4599-af82-3cd323a7e441","stack":"TypeError: Cannot read properties of undefined (reading 'findMany')\n    at Object.getOrders (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/online-ordering/checkout.service.js:469:23)\n    at listOrders (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/online-ordering/checkout.controller.js:106:42)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:49:7","url":"/api/checkout/orders","userAgent":"PostmanRuntime/7.50.0"},"service":"truetab-api","timestamp":"2025-11-14T05:32:34.471Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findUnique')","ip":"::1","method":"GET","requestId":"4d7cce91-ea42-4f9d-a690-9d0f2bbfa115","stack":"TypeError: Cannot read properties of undefined (reading 'findUnique')\n    at Object.getForBranch (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.service.js:5:31)\n    at get (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/service-charge/service.controller.js:5:26)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:41:7","url":"/api/service-charge/4731d011-8789-4347-abe6-978ab7e0e3ba","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:35:15.663Z"}
{"level":"error","message":"Error generating recommendations: Cannot read properties of undefined (reading 'groupBy')","service":"truetab-api","stack":"TypeError: Cannot read properties of undefined (reading 'groupBy')\n    at RecommendationService.getPopularItems (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/recommendation.service.js:76:49)\n    at RecommendationService.getMenuRecommendations (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/recommendation.service.js:25:39)\n    at getRecommendations (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/ai.controller.js:16:59)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/aiFeatureAccess.js:255:5\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/aiFeatureAccess.js:139:7","timestamp":"2025-11-14T05:37:57.149Z"}
{"level":"error","message":"Get recommendations error: Cannot read properties of undefined (reading 'groupBy')","service":"truetab-api","stack":"TypeError: Cannot read properties of undefined (reading 'groupBy')\n    at RecommendationService.getPopularItems (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/recommendation.service.js:76:49)\n    at RecommendationService.getFallbackRecommendations (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/recommendation.service.js:230:37)\n    at RecommendationService.getMenuRecommendations (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/recommendation.service.js:68:19)\n    at async getRecommendations (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/ai.controller.js:16:31)","timestamp":"2025-11-14T05:37:57.150Z"}
{"level":"error","message":"Error forecasting demand: Cannot read properties of undefined (reading 'findMany')","service":"truetab-api","stack":"TypeError: Cannot read properties of undefined (reading 'findMany')\n    at ForecastingService.getHistoricalSales (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/forecasting.service.js:170:39)\n    at ForecastingService.forecastMenuItemDemand (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/forecasting.service.js:24:41)\n    at forecastDemand (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/ai.controller.js:66:49)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/aiFeatureAccess.js:255:5\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/aiFeatureAccess.js:139:7","timestamp":"2025-11-14T05:38:09.049Z"}
{"level":"error","message":"Forecast demand error: Failed to generate forecast: Cannot read properties of undefined (reading 'findMany')","service":"truetab-api","stack":"Error: Failed to generate forecast: Cannot read properties of undefined (reading 'findMany')\n    at ForecastingService.forecastMenuItemDemand (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/forecasting.service.js:66:13)\n    at async forecastDemand (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/ai/ai.controller.js:66:24)","timestamp":"2025-11-14T05:38:09.050Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'id')","ip":"::1","method":"GET","requestId":"b17789de-3cab-4a15-a847-8727b119af3c","stack":"TypeError: Cannot read properties of undefined (reading 'id')\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:27:26\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at Route.dispatch (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:117:3)\n    at handle (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:435:11)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:295:15\n    at processParams (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:582:12)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:291:5)\n    at Function.handle (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/index.js:186:3)","url":"/api/reviews","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:39:22.808Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findFirst')","ip":"::1","method":"GET","requestId":"d77212ad-7293-4ddd-ae80-376f0f6ce00e","stack":"TypeError: Cannot read properties of undefined (reading 'findFirst')\n    at Object.getBrandOnlineMenu (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/online-ordering/menu.service.js:186:40)\n    at getBrandMenu (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/online-ordering/menu.controller.js:68:36)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:49:7","url":"/api/online-menu/7d578988-9df3-4b73-9111-8ad9e37fc0b0","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:43:19.962Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findFirst')","ip":"::1","method":"GET","requestId":"a7355b83-68c3-456f-aab3-cebcdbe5f4c1","stack":"TypeError: Cannot read properties of undefined (reading 'findFirst')\n    at getOrCreateWallet (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/wallet.service.js:9:46)\n    at Object.getWalletSummary (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/wallet.service.js:147:24)\n    at getSummary (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/wallet.controller.js:8:41)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:49:7","url":"/api/wallet/summary","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:43:31.611Z"}
{"level":"error","message":{"error":"Cannot read properties of undefined (reading 'findFirst')","ip":"::1","method":"GET","requestId":"fa95bb67-0d5a-4108-a28e-1d6b8f62e7e0","stack":"TypeError: Cannot read properties of undefined (reading 'findFirst')\n    at getOrCreateWallet (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/wallet.service.js:9:46)\n    at Object.getTransactionHistory (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/wallet.service.js:181:24)\n    at getTransactions (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/wallet/wallet.controller.js:24:46)\n    at Layer.handleRequest (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/router/lib/route.js:157:13)\n    at /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:49:7","url":"/api/wallet/transactions","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:43:41.876Z"}
{"level":"error","message":{"error":"Gift card not found","ip":"::1","method":"GET","requestId":"30be6d3b-1479-48f1-8e46-faf741c56433","stack":"Error: Gift card not found\n    at Object.checkBalance (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/gift-cards/gift-cards.service.js:86:11)\n    at async checkBalance (/Users/victoryunusa/Documents/Websites/new/truetab-api/src/modules/gift-cards/gift-cards.controller.js:33:21)","url":"/api/gift-cards/22470ddc-6d93-40d6-80a3-96e7c1a008f2/balance","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:47:29.741Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.","ip":"::1","method":"POST","requestId":"f60667e3-3864-4a93-bd08-6b2f7cfd8cb5","stack":"PrismaClientKnownRequestError: \nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:7283)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:25","url":"/api/inventory/suppliers","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:56:09.969Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.subscription.findUnique()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:12:45\n\n   9 if (!brandId)\n  10   return res.status(400).json({ error: \"brandId is required\" });\n  11 \n→ 12 const sub = await prisma.subscription.findUnique(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.","ip":"::1","method":"POST","requestId":"a51df52c-4a52-4392-806d-e5d92578d980","stack":"PrismaClientKnownRequestError: \nInvalid `prisma.subscription.findUnique()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:12:45\n\n   9 if (!brandId)\n  10   return res.status(400).json({ error: \"brandId is required\" });\n  11 \n→ 12 const sub = await prisma.subscription.findUnique(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:7283)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/subscription.js:12:19","url":"/api/inventory/suppliers","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T05:56:40.104Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.","ip":"::1","method":"GET","requestId":"d0679f23-af50-41ea-b78f-c0a1a8a8f8f4","stack":"PrismaClientKnownRequestError: \nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:7283)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:25","url":"/api/floor/tables/3e08f3de-b456-4692-9495-a18018f33283/qrcode","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T06:01:43.799Z"}
{"level":"error","message":{"error":"\nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.","ip":"::1","method":"GET","requestId":"50b8dc75-0b3d-4491-a3b4-4543d8e474c2","stack":"PrismaClientKnownRequestError: \nInvalid `prisma.user.findFirst()` invocation in\n/Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:43\n\n  22 \n  23 // If not super admin, user must belong to this brand or own it\n  24 if (brandId && req.user?.role !== Role.SUPER_ADMIN) {\n→ 25   const belongs = await prisma.user.findFirst(\nCan't reach database server at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`\n\nPlease make sure your database server is running at `ep-ancient-salad-ae9c8qbs-pooler.c-2.us-east-2.aws.neon.tech:5432`.\n    at ei.handleRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:7283)\n    at ei.handleAndLogRequestError (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6608)\n    at ei.request (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:121:6315)\n    at async a (/Users/victoryunusa/Documents/Websites/new/truetab-api/node_modules/@prisma/client/runtime/library.js:130:9551)\n    at async /Users/victoryunusa/Documents/Websites/new/truetab-api/src/middleware/tenant.js:25:25","url":"/api/kds/tickets","userAgent":"PostmanRuntime/7.49.1"},"service":"truetab-api","timestamp":"2025-11-14T06:11:51.222Z"}
